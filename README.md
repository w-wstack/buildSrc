# buildSrc

[libs.versions.toml](../gradle/libs.versions.toml)
```toml

# This file was generated by the Gradle 'init' task.
# https://docs.gradle.org/current/userguide/platforms.html#sub::toml-dependencies-format
[versions]
# global versions
jdk = "21"

# dependency versions
kotlinLogging = "7.0.12"
lorem = "2.2"
j2html = "1.6.0"
aws-lambda-java-core = "1.2.2"
aws-lambda-java-events = "3.11.1"
aws-lambda-java-serialization = "1.0.0"
spring-cloud-dependencies = "2025.0.0"
spring-cloud-aws-dependencies = "3.4.0"
software-amazon-awssdk = "2.33.0"
aws-xray = "2.19.0"

# plugin versions
springBoot = "3.5.5"
springGradleDependencyManagement = "1.1.7"
graalvmBuildTools = "0.10.3"
kotlin = "2.2.20"
detekt = "1.23.8"
dokka = "2.0.0"
spotbugs-gradle = "6.0.4"
spotbugs = "4.9.7"
findsecbugs-plugin = "1.14.0"
spotless = "8.0.0"
testLogger = "4.0.0"
jacocolog = "3.1.0"
jacocoVersion = "0.8.13"
cucumberReporting = "0.1.25"

# test Tools
cucumber = "7.19.0"
mockk = "1.14.0"
koTest = "5.9.1"
kotest-extensions-spring = "1.3.0"
kotest-extensions-testcontainers = "2.0.2"
junitPlatformSuiteVersion = "1.9.0"
springmockk = "4.0.2"
pact-jvm = "4.6.3"

[plugins]

[libraries]
# project dependencies
microutils-kotlinLogging = { module = "io.github.oshai:kotlin-logging-jvm", version.ref = "kotlinLogging" }
lorem = { module = "com.thedeanda:lorem", version.ref = "lorem" }
j2html = { module = "com.j2html:j2html", version.ref = "j2html" }
aws-lambda-java-core = { module = "com.amazonaws:aws-lambda-java-core", version.ref = "aws-lambda-java-core" }
aws-lambda-java-events = { module = "com.amazonaws:aws-lambda-java-events", version.ref = "aws-lambda-java-events" }
aws-lambda-java-serialization = { module = "com.amazonaws:aws-lambda-java-serialization", version.ref = "aws-lambda-java-serialization" }

# test dependencies

# BOM dependencies
springCloud-bom = { module = "org.springframework.cloud:spring-cloud-dependencies", version.ref = "spring-cloud-dependencies" }
springCloudAwsDependencies-bom = { module = "io.awspring.cloud:spring-cloud-aws-dependencies", version.ref = "spring-cloud-aws-dependencies" }
aws-sdk-bom = { module = "software.amazon.awssdk:bom", version.ref = "software-amazon-awssdk" }
aws-xray-bom = { module = "com.amazonaws:aws-xray-recorder-sdk-bom", version.ref = "aws-xray" }

# buildSrc dependencies (plugins)
kotlin-gradlePlugin = { module = "org.jetbrains.kotlin:kotlin-gradle-plugin", version.ref = "kotlin" }
kotlin-allopenPlugin = { module = "org.jetbrains.kotlin:kotlin-allopen", version.ref = "kotlin" }
kotlin-noargPlugin = { module = "org.jetbrains.kotlin:kotlin-noarg", version.ref = "kotlin" }
springBoot-gradlePlugin = { module = "org.springframework.boot:spring-boot-gradle-plugin", version.ref = "springBoot" }
spring-dependencyManagementPlugin = { module = "io.spring.gradle:dependency-management-plugin", version.ref = "springGradleDependencyManagement" }
graalvm-buildtoolsNativeGradlePlugin = { module = "org.graalvm.buildtools.native:org.graalvm.buildtools.native.gradle.plugin", version.ref = "graalvmBuildTools" }
detekt-gradlePlugin = { module = "io.gitlab.arturbosch.detekt:detekt-gradle-plugin", version.ref = "detekt" }
dokka-gradlePlugin = { module = "org.jetbrains.dokka:dokka-gradle-plugin", version.ref = "dokka" }
spotbugs-gradlePlugin = { module = "com.github.spotbugs.snom:spotbugs-gradle-plugin", version.ref = "spotbugs-gradle" }
spotless-gradlePlugin = { module = "com.diffplug.spotless:spotless-plugin-gradle", version.ref = "spotless" }
testLogger-gradlePlugin = { module = "com.adarshr:gradle-test-logger-plugin", version.ref = "testLogger" }
jacocolog-gradlePlugin = { module = "org.barfuin.gradle.jacocolog:gradle-jacoco-log", version.ref = "jacocolog" }
cucumberReporting-gradlePlugin = { module = "com.github.spacialcircumstances:gradle-cucumber-reporting", version.ref = "cucumberReporting" }

spotbugs = { module = "com.github.spotbugs:spotbugs", version.ref = "spotbugs"}
findsecbugs-plugin = { module = "com.h3xstream.findsecbugs:findsecbugs-plugin", version.ref = "findsecbugs-plugin"}

# Detekt plugins
detekt-formatting = { module = "io.gitlab.arturbosch.detekt:detekt-formatting", version.ref = "detekt" }



# Test Tools
mockk = { module = "io.mockk:mockk", version.ref = "mockk" }
kotest = { module = "io.kotest:kotest-runner-junit5", version.ref = "koTest" }
kotest-assertions-json = { module = "io.kotest:kotest-assertions-json", version.ref = "koTest" }
kotest-extensions-testcontainers = { module = "io.kotest.extensions:kotest-extensions-testcontainers", version.ref = "kotest-extensions-testcontainers" }
kotest-extensions-spring = { module = "io.kotest.extensions:kotest-extensions-spring", version.ref = "kotest-extensions-spring" }
testcontainers-junit = { module = "org.testcontainers:junit-jupiter" }
testcontainers-mongodb = { module = "org.testcontainers:mongodb" }
springmockk = { module = "com.ninja-squad:springmockk", version.ref = "springmockk" }
junit-platform-suite = { module = "org.junit.platform:junit-platform-suite", version.ref = "junitPlatformSuiteVersion" }
cucumber-java8 = { module = "io.cucumber:cucumber-java8", version.ref = "cucumber" }
cucumber-junit = { module = "io.cucumber:cucumber-junit", version.ref = "cucumber" }
cucumber-junit-platform-engine = { module = "io.cucumber:cucumber-junit-platform-engine", version.ref = "cucumber" }
cucumber-guice = { module = "io.cucumber:cucumber-guice", version.ref = "cucumber" }
cucumber-spring = { module = "io.cucumber:cucumber-spring", version.ref = "cucumber" }



[bundles]
logging = ["microutils-kotlinLogging"]
lorem = ["lorem"]
j2html = ["j2html"]
aws-lambda = ["aws-lambda-java-core", "aws-lambda-java-events", "aws-lambda-java-serialization"]
kotest = ["kotest", "mockk"]
koTestSpring = ["kotest", "kotest-extensions-spring", "mockk", "springmockk", "kotest-extensions-testcontainers", "kotest-assertions-json"]
cucumber = ["junit-platform-suite", "cucumber-java8", "cucumber-junit", "cucumber-junit-platform-engine"]
cucumberSpring = ["junit-platform-suite", "cucumber-java8", "cucumber-junit", "cucumber-junit-platform-engine", "cucumber-spring", "springmockk"]

```

[gradle.properties](../gradle.properties)
```properties
# This file was generated by the Gradle 'init' task.
# https://docs.gradle.org/current/userguide/build_environment.html#sec:gradle_configuration_properties

org.gradle.configuration-cache=false
org.gradle.parallel=true
org.gradle.caching=true


```
[build.gradle.kts](../build.gradle.kts)
```kotlin
plugins {
    idea
}

idea {
    module.isDownloadJavadoc = true
    module.isDownloadSources = true
}

tasks {
    wrapper {
        distributionType = Wrapper.DistributionType.ALL
    }
}
```
[settings.gradle.kts](../settings.gradle.kts)
```kotlin
rootProject.name = "root-platform"

include("platform-domain")
include("platform-lambda")
include("platform-outbound")

```
[spotbugs-exclude.xml](../spotbugs-exclude.xml)
```xml
<FindBugsFilter>
    <Match>
        <Bug code="SECCRLFLOG"/>
    </Match>
</FindBugsFilter>
```
[spotbugs-include.xml](../spotbugs-include.xml)
```xml
<FindBugsFilter>
    <Match>
        <Bug category="SECURITY"/>
    </Match>
</FindBugsFilter>
```

[build.gradle.kts](../platform-domain/build.gradle.kts)
```kotlin
plugins {
    id("kotlin-conventions")
    id("testing-conventions")
//    id("dokka-conventions")
//  id("publishing-conventions") // If everything was configured correctly, you could use it to publish the artifacts. But it is not working with Spring as I thought.
    id("spring-conventions")
    id("native-conventions")
}

dependencies {
    implementation("com.fasterxml.jackson.module:jackson-module-kotlin")
    implementation("org.jetbrains.kotlin:kotlin-reflect")
    implementation("org.jetbrains.kotlin:kotlin-stdlib-jdk8")
    implementation(libs.bundles.logging)
    testImplementation(libs.bundles.kotest)
}

tasks.jar { enabled = true }
tasks.bootJar { enabled = false }

// Disable Spring Boot application tasks for library module
tasks.named("bootBuildImage") { enabled = false }
tasks.matching { it.name == "bootRun" }.configureEach { enabled = false }
tasks.matching { it.name == "processAot" }.configureEach { enabled = false }
tasks.matching { it.name == "processTestAot" }.configureEach { enabled = false }

// Disable native compilation tasks for library module
tasks.matching { it.name == "nativeBuild" }.configureEach { enabled = false }
tasks.matching { it.name == "nativeCompile" }.configureEach { enabled = false }
tasks.matching { it.name == "nativeTestCompile" }.configureEach { enabled = false }
tasks.matching { it.name == "nativeTestBuild" }.configureEach { enabled = false }

//dependencyManagement {
//    imports {
//        mavenBom(libs.springCloud.bom.get().toString())
//        mavenBom(libs.aws.xray.bom.get().toString())
//        mavenBom(libs.aws.sdk.bom.get().toString())
//    }
//}


```
[build.gradle.kts](../platform-lambda/build.gradle.kts)
```kotlin
plugins {
    id("kotlin-conventions")
    id("testing-conventions")
//    id("dokka-conventions")
//  id("publishing-conventions") // If everything was configured correctly, you could use it to publish the artifacts. But it is not working with Spring as I thought.
    id("spring-conventions")
    id("native-conventions")
}

dependencies {
    implementation("io.github.crac:org-crac:0.1.3")
    implementation("com.fasterxml.jackson.module", "jackson-module-kotlin")


    implementation("org.jetbrains.kotlin:kotlin-reflect")
    implementation(project(":platform-domain"))
    implementation(project(":platform-outbound"))

    implementation("org.springframework.boot:spring-boot-starter-web")
    implementation("org.springframework.boot:spring-boot-starter-actuator")
    implementation("org.springframework.cloud:spring-cloud-function-adapter-aws")
    implementation("org.springframework.boot:spring-boot-starter-security")
    implementation("org.springframework.boot:spring-boot-starter-oauth2-resource-server")

    implementation(platform(libs.springCloudAwsDependencies.bom.get().toString()))
    implementation("io.awspring.cloud:spring-cloud-aws-starter-dynamodb")
    implementation(libs.bundles.aws.lambda)

    implementation("com.amazonaws:aws-xray-recorder-sdk-core")
    implementation("com.amazonaws:aws-xray-recorder-sdk-apache-http")
    implementation("com.amazonaws:aws-xray-recorder-sdk-aws-sdk")
    implementation("com.amazonaws:aws-xray-recorder-sdk-aws-sdk-instrumentor")
    implementation("com.amazonaws:aws-xray-recorder-sdk-aws-sdk-v2")

    developmentOnly("org.springframework.boot:spring-boot-devtools")

    testImplementation("org.springframework.boot:spring-boot-starter-test")
}

dependencyManagement {
    imports {
        mavenBom(libs.springCloud.bom.get().toString())
        mavenBom(libs.aws.xray.bom.get().toString())
        mavenBom(libs.aws.sdk.bom.get().toString())
    }
}

graalvmNative {
    binaries {
        named("main") {
            buildArgs.addAll(
                "--enable-url-protocols=http",
                "-H:+AddAllCharsets"
            )
        }
    }
}
```
[build.gradle.kts](../platform-outbound/build.gradle.kts)
```kotlin
/*
 * Outbound Adapters Module - Infrastructure Implementations
 *
 * This module contains implementations of outbound ports:
 * - DynamoDB repositories
 * - Password encoder (BCrypt)
 * - Token generator (JWT)
 * - AWS clients configuration
 */

plugins {
    id("kotlin-conventions")
    id("spring-conventions")
    id("testing-conventions")
}

dependencies {
    // Module dependencies
    implementation(project(":platform-domain"))

    // Kotlin
    implementation("org.jetbrains.kotlin:kotlin-reflect")

    // Spring Boot
    implementation("org.springframework.boot:spring-boot-starter")
    implementation("org.springframework.security:spring-security-crypto")
    implementation("org.springframework.boot:spring-boot-starter-oauth2-resource-server")

    // AWS SDK for Kotlin
    implementation(platform(libs.springCloudAwsDependencies.bom.get().toString()))
    implementation("io.awspring.cloud:spring-cloud-aws-starter-dynamodb")

    // JWT
    implementation("io.jsonwebtoken:jjwt-api:0.12.6")
    runtimeOnly("io.jsonwebtoken:jjwt-impl:0.12.6")
    runtimeOnly("io.jsonwebtoken:jjwt-jackson:0.12.6")

    // Testing
    testImplementation("org.springframework.boot:spring-boot-starter-test")
    testImplementation("org.testcontainers:testcontainers")
    testImplementation("org.testcontainers:localstack")
    testImplementation("io.mockk:mockk:1.13.12")
}

dependencyManagement {
    imports {
        mavenBom(libs.springCloud.bom.get().toString())
        mavenBom(libs.aws.xray.bom.get().toString())
        mavenBom(libs.aws.sdk.bom.get().toString())
    }
}

// Disable Spring Boot tasks for library module
tasks.matching { it.name == "bootJar" }.configureEach { enabled = false }
tasks.matching { it.name == "bootBuildImage" }.configureEach { enabled = false }
tasks.matching { it.name == "bootRun" }.configureEach { enabled = false }

// Disable native compilation tasks for library module
tasks.matching { it.name == "nativeBuild" }.configureEach { enabled = false }
tasks.matching { it.name == "nativeCompile" }.configureEach { enabled = false }
tasks.matching { it.name == "nativeTestCompile" }.configureEach { enabled = false }

```
